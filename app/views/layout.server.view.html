<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
	<title>{{title}}</title>

	<!-- General META -->
	<meta charset="utf-8">
	<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">

	<!-- Semantic META -->
	<meta name="keywords" content="{{keywords}}">
	<meta name="description" content="{{description}}">

	<!-- Facebook META -->
	<meta property="fb:app_id" content="{{facebookAppId}}">
	<meta property="og:site_name" content="{{title}}">
	<meta property="og:title" content="{{title}}">
	<meta property="og:description" content="{{description}}">
	<meta property="og:url" content="{{url}}">
	<meta property="og:image" content="/img/brand/logo.png">
	<meta property="og:type" content="website">

	<!-- Twitter META -->
	<meta name="twitter:title" content="{{title}}">
	<meta name="twitter:description" content="{{description}}">
	<meta name="twitter:url" content="{{url}}">
	<meta name="twitter:image" content="/img/brand/logo.png">

	<!-- Fav Icon -->
	<link href="/modules/core/img/brand/favicon.ico" rel="shortcut icon" type="image/x-icon">

	<!--Application CSS Files-->
	{% for cssFile in cssFiles %}<link rel="stylesheet" href="{{cssFile}}">{% endfor %}



	<!-- HTML5 Shim -->
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
</head>

<body class="ng-cloak">
	<header data-ng-include="'/modules/core/views/header.client.view.html'" class="navbar navbar-fixed-top navbar-inverse"></header>
	<section class="content">
		<section class="container">
			{% block content %}{% endblock %}
		</section>
	</section>

	<!--Embedding The User Object-->
	<script type="text/javascript">
		var user = {{ user | json | safe }};
	</script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js" charset="utf-8"></script>

	<script type="text/javascript">
    //Width and height
    var w = 500;
    var h = 500;
    var barPadding = 1;

    var dataset = [25, -10, 35, -20, 5, -30, 15]; //this will be profile ratings
    var dataDesc = [
      ["more liberal", "more conservative"],
      ["more emphasis on diversity", "less emphasis on diversity"],
      ["more practice", "more casual"],
      ["more direct", "more passive"],
      ["more cut and dry", "more compassionate"],
      ["pushes boundaries", "more inclusive"],
      ["more industry-driven", "more craft-driven"]
    ];

    var dataObj = function(val, desc) {
      this.value = val;
      this.desc = desc;
    };
    var graphPoints = [];
    for (var i = 0; i < dataset.length; i++) {
      if (dataset[i] >= 0) {
        var graphObj = new dataObj(dataset[i], dataDesc[i][0]);
      } else var graphObj = new dataObj(dataset[i], dataDesc[i][1]);
      graphPoints.push(graphObj);
    }

    //Create SVG element
    var svg = d3.select(".container") //change this to the appropriate div
      .append("svg")
      .attr("width", w)
      .attr("height", h);

    svg.selectAll("rect")
      .data(graphPoints) // maybe put the data inside an object so we can recall names
      .enter()
      .append("rect")
      .attr("x", function(d) {
        if (d.value >= 0) {
          return (w / 2) - (d.value * 4);
        } else {
          return (w / 2);
        }
      })
      .attr("y", function(d, i) {
        // return h - (d * 4);
        return i * ((h / 4) / dataset.length);
      })
      .attr("height", (h / 4) / dataset.length - barPadding)
      .attr("width", function(d) {
        // console.log(d)
        return Math.abs(d.value) * 4;
      })
      .attr("fill", function(d) { //change colors to match scheme later
        if (d.value >= 0) return "rgb(150, 100, " + (d.value * 10) + ")";
        else return "rgb(150, " + (Math.abs(d.value) * 10) + ", 100)";
      });

    svg.selectAll("text")
      .data(graphPoints)
      .enter()
      .append("text")
      .text(function(d) {
        return d.desc;
      })
      .attr("text-anchor", function(d) {
        return d.value >= 0 ? "left" : "right";
      })
      .attr("x", function(d) {
        if (d.value <= 0) {
          return (w / 2) - (d.desc.length * 7);
        } else {
          return (w / 2) + 10;
        }
      })
      .attr("y", function(d, i) {
        return i * ((h / 4) / dataset.length) + (h / 4) / dataset.length - barPadding - 5;
      })
      .attr("font-family", "Courier New")
      .attr("font-size", "11px")
      .attr("fill", "black");
    </script>

	<!--Application JavaScript Files-->
	{% for jsFile in jsFiles %}<script type="text/javascript" src="{{jsFile}}"></script>{% endfor %} 

	{% if process.env.NODE_ENV === 'development' %}
	<!--Livereload script rendered -->
	<script type="text/javascript" src="http://{{request.hostname}}:35729/livereload.js"></script>
	{% endif %}
</body>

</html>